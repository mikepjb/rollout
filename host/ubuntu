#!/bin/bash -e

# Set the keyboard permanently to US w/ ctrl as caps:
sudo sed -i \
  -e 's/XKBLAYOUT=\"\w*"/XKBLAYOUT=\"us\"/g' \
  -e 's/XKBOPTIONS=\"\w*"/XKBOPTIONS=\"ctrl:nocaps\"/g' \
  /etc/default/keyboard


# TODO should probably update too..
sudo apt install -y \
  curl \
  tmux \
  vim-gtk3 \
  build-essential \
  apt-file \
  htop \
  gimp \
  git-crypt

# Install the latest Node LTS:
if ! command -v node; then
  curl -sL https://deb.nodesource.com/setup_13.x | sudo -E bash -
  # TODO something weird happened when doing this manually:
  # - initially I had no npm
  # - .. did some stuff (maybe sudo apt-get update?)
  # - sudo apt-get install nodejs provided npm (althought sudo apt-get install
  #   npm ubuntu package still could not resolve it's dependencies')
  sudo apt-get install -y nodejs

  mkdir -p ~/.config/npm
  npm config set prefix '~/.config/npm'

  # give yourself write permissions for node modules
  # sudo mkdir -p /usr/lib/node_modules
  # sudo chown -R $USER /usr/lib/node_modules
fi

# TODO hide firefox titlebar by script (currently change via customize menu item => checkbox)

# update bluez to >=5.28.2 at avoid awful feedback loop bug on noise cancelling headphones:
# sudo add-apt-repository ppa:bluetooth/bluez
# sudo apt update
# sudo apt install bluez

# at the time of creation, firefox 72.0.1 showed grey corners in CSD mode (condensed titlebar), setting layers.acceleration.force-enabled to true and restarting removed them.
